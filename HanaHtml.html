<!DOCTYPE html>
<html>
<head> <style type="text/css">

@import url('https://fonts.googleapis.com/css?family=Open+Sans:400,700');

* {
  box-sizing: border-box;
}

body {
  padding: 0;
  margin: 0;
  font-family: 'Open Sans', sans-serif;
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}

.card {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.26);
}

.card__header,
.card__content {
  padding: 1rem;

}

.form label,
.form input {
    display: block;
    width: 100%;
    margin-bottom: 0.25rem;
}
	
.grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-around;
  align-items: stretch;
  padding-top: 1rem;
}

.product-item {
	
    width: 40rem;
	max-width: 95%;
	padding-top: 1rem;
}

.span {
	font-weight: bold
}

.droptarget {
  float: left; 
  width: 250px; 
  height: 200px;
  margin: 15px;
  padding: 10px;
  border: 1px solid #aaaaaa;
}

</style></head>
<!--<body onLoad="loadXMLDoc()">-->
<body>
<form action="#">
  	
<div class="grid">
        <article class="card product-item">
			
<details open="open"><summary>ZPPSReagentCompliance</summary><ul>
	
	<details open="open">
	<summary>DIMENSIONS</summary><ul>
    
    <li ondragstart="dragStart(event)" draggable="true" id="Area">Area</li>
    
    <li ondragstart="dragStart(event)" draggable="true" id="AreaDesc">AreaDesc</li>
    
    <li ondragstart="dragStart(event)" draggable="true" id="AreaManagerName">AreaManagerName</li>
	
	<li ondragstart="dragStart(event)" draggable="true" id="AreaManagerNameTest">AreaManagerNameTest</li>
	
	</ul>
	</details>
	
	
	<details><summary>MEASURES</summary><ul>

    <li ondragstart="dragStart(event)" draggable="true" id="BIllingNetPlanRateUSD">BIllingNetPlanRateUSD</li>
    
    <li ondragstart="dragStart(event)" draggable="true" id="BillingNetTranCurr">BillingNetTranCurr</li>
    
    <li ondragstart="dragStart(event)" draggable="true" id="BillingNetTranCurr">BillingNetTranCurr</li>
	
	<li ondragstart="dragStart(event)" draggable="true" id="BillingNetTranCurrTest">BillingNetTranCurrTest</li>
	
	
	</ul>
	</details>
	
	<details><summary>TIME_DIMENSIONS</summary><ul>
	
    <li ondragstart="dragStart(event)" draggable="true" id="BillingDate">BillingDate</li>
    
    <li ondragstart="dragStart(event)" draggable="true" id="CYContractEndDate">CYContractEndDate</li>

    <li ondragstart="dragStart(event)" draggable="true" id="CYContractEndDate">CYContractStartDate</li>

    <li ondragstart="dragStart(event)" draggable="true" id="CYContractEndDate">ContractChangeDate</li>

    <li ondragstart="dragStart(event)" draggable="true" id="CYContractEndDate">CYContractEndOtherDate</li>

	</details></li></ul>
	
	</details> 

</article>

<article id ="displayContentId" class="card product-item">
    <div id='Dimension' class="droptarget" ondrop="dropDim(event)" ondragover="allowDrop(event)" >
        <labe >Dimension</label>
        <p id='labelDimensionText'></p>
    </div>

    <div id='Measures' class="droptarget" ondrop="dropMes(event)" ondragover="allowDrop(event)">
        <label>Measures</label>
        <p id='labelMeasuresext'></p>
    </div>

    <div id='Filters' class="droptarget" ondrop="dropFil(event)" ondragover="allowDrop(event)">
        <label>Filters</label>
        <p id='labelFiltersText'></p>
    </div>

</article>
<br><br>
<article class="card product-item">
    
    <!-- <textarea id='DimensionText' aria-valuetext="Test"></textarea> -->

    <input type="button" id="btn" value="Download" /> 
</article>
</div>
 
</form>

</body>
</html>

<script>
    var dimension = [];
    var measures = [];
    var filters = [];

    function dragStart(event) {
      event.dataTransfer.setData("Text", event.target.id);
      console.log(event.target.id)
    }
    
    function allowDrop(event) {
      event.preventDefault();
    }
    
    // function drop(event) {
    //   event.preventDefault();
    //   var data = event.dataTransfer.getData("Text");
    //   var divData = event.target.appendChild(document.getElementById(data).cloneNode(true));
    //   //Dimension.push( event.target.appendChild(document.getElementById(data).cloneNode(true)));
    // }

    //Dimensions
    function dropDim(event) {
      event.preventDefault();
      var data = event.dataTransfer.getData("Text");
      //event.target.appendChild(document.getElementById(data).cloneNode(true));// display drable items
      
      //check if the selected item already avaiable in Measures?
      if(measures.includes(data))
        alert('Cant move the same elements in Dimesions and measures');
      else
        dimension.push(data);
        dimension = getUnique(dimension);

        document.getElementById("labelDimensionText").innerHTML = "<table>"+ corssMarkAppend(dimension).join(" ") +"</table>";
    }

    function corssMarkAppend(array){
        var crossMarkApp = [];
       // var buttonAddstart = "<input type='submit' onClick='itemRemove(this, "+array+", "+ labelId + ");' value=";
        var buttonAddstart = "<tr><td><input type='button' onclick='deleteRowFunction(this, "+array+");'  value=X id=";
        var buttonAddend = "</input></td></tr>";
        // Loop through array values
        for(var value of array){
            if(crossMarkApp.indexOf(value) === -1){
                crossMarkApp.push(buttonAddstart+value+"> "+value+buttonAddend);
            }
        }
        return crossMarkApp;
    }

    function deleteRowFunction(obj, array) {
      // event.target will be the input element.
      var td = event.target.parentNode; 
      var tr = td.parentNode; // the row to be removed
      tr.parentNode.removeChild(tr);
      dimension = dimension.filter(e => e !== obj.id);
    }

    //Measures
    function dropMes(event) {
      event.preventDefault();
      var data = event.dataTransfer.getData("Text");
      //event.target.appendChild(document.getElementById(data).cloneNode(true));// display drable items
      if(dimension.includes(data))
        alert('Cant move the same elements in Dimesions and measures');
      else
        measures.push(data);
      measures = getUnique(measures);//Duplicate removal 
      //document.getElementById("labelMeasuresext").innerHTML = measures.join(" ");
      document.getElementById("labelMeasuresext").innerHTML = "<table>"+ corssMarkAppendM(measures).join(" ") +"</table>";
    }

    function corssMarkAppendM(array){
        var crossMarkApp = [];
       // var buttonAddstart = "<input type='submit' onClick='itemRemove(this, "+array+", "+ labelId + ");' value=";
        var buttonAddstart = "<tr><td><input type='button' onclick='deleteRowFunctionM(this, "+array+");'  value=X id=";
        var buttonAddend = "</input></td></tr>";
        // Loop through array values
        for(var value of array){
            if(crossMarkApp.indexOf(value) === -1){
                crossMarkApp.push(buttonAddstart+value+"> "+value+buttonAddend);
            }
        }
        return crossMarkApp;
    }

    function deleteRowFunctionM(obj, array) {
      // event.target will be the input element.
      var td = event.target.parentNode; 
      var tr = td.parentNode; // the row to be removed
      tr.parentNode.removeChild(tr);
      measures = measures.filter(e => e !== obj.id);
    }


    //filters
    function dropFil(event) {
      event.preventDefault();
      var data = event.dataTransfer.getData("Text");
      //event.target.appendChild(document.getElementById(data).cloneNode(true));// display drable items
      filters.push(data);
      filters = getUnique(filters);//Duplicate removal 
      //document.getElementById("labelFiltersText").innerHTML = filters.join(" ");
      document.getElementById("labelFiltersText").innerHTML = "<table>"+ corssMarkAppendF(filters).join(" ") +"</table>";
    }

    
    function corssMarkAppendF(array){
        var crossMarkApp = [];
       // var buttonAddstart = "<input type='submit' onClick='itemRemove(this, "+array+", "+ labelId + ");' value=";
        var buttonAddstart = "<tr><td><input type='button' onclick='deleteRowFunctionF(this, "+array+");'  value=X id=";
        var buttonAddend = "</input></td></tr>";
        // Loop through array values
        for(var value of array){
            if(crossMarkApp.indexOf(value) === -1){
                crossMarkApp.push(buttonAddstart+value+"> "+value+buttonAddend);
            }
        }
        return crossMarkApp;
    }

    function deleteRowFunctionF(obj, array) {
      // event.target will be the input element.
      var td = event.target.parentNode; 
      var tr = td.parentNode; // the row to be removed
      tr.parentNode.removeChild(tr);
      filters = filters.filter(e => e !== obj.id);
    }

    function getUnique(array){
        var uniqueArray = [];
        // Loop through array values
        for(var value of array){
            if(uniqueArray.indexOf(value) === -1){
                uniqueArray.push(value);
            }
        }
        return uniqueArray;
    }
    var xml = "";
    function printXml() {
            xml = '<?xml version="1.0" encoding="UTF-8"?><Root><Classes>\n';
            xml += "<Class Dimensions='" + dimension + "'>\n";
            xml += "</Class>\n";
			xml += "<Class Measures='" + measures + "'>\n";
            xml += "</Class>\n";
			xml += "<Class Filters='" + filters + "'>\n";
            xml += "</Class>\n";
            xml += '</Classes></Root>';
            window.alert(xml);
    }

function download(file, text) { 
  var element = document.createElement('a'); 
  element.setAttribute('href', 'data:text/plain;charset=utf-8, ' 
                       + encodeURIComponent(text)); 
  element.setAttribute('download', file); 
  document.body.appendChild(element); 
  element.click(); 
  document.body.removeChild(element); 
} 

// Start file download. 
document.getElementById("btn").addEventListener("click", function() { 
    var filename = "myFile.xml"; 
    printXml();
    download(filename, xml); 
}, false); 


</script>

